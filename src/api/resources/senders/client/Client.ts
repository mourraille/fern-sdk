// This file was auto-generated by Fern from our API Definition.

import type { BaseClientOptions, BaseRequestOptions } from "../../../../BaseClient.js";
import { type NormalizedClientOptionsWithAuth, normalizeClientOptionsWithAuth } from "../../../../BaseClient.js";
import { mergeHeaders } from "../../../../core/headers.js";
import * as core from "../../../../core/index.js";
import * as environments from "../../../../environments.js";
import { handleNonStatusCodeError } from "../../../../errors/handleNonStatusCodeError.js";
import * as errors from "../../../../errors/index.js";
import * as BrevoApi from "../../../index.js";

export declare namespace SendersClient {
    export type Options = BaseClientOptions;

    export interface RequestOptions extends BaseRequestOptions {}
}

export class SendersClient {
    protected readonly _options: NormalizedClientOptionsWithAuth<SendersClient.Options>;

    constructor(options: SendersClient.Options) {
        this._options = normalizeClientOptionsWithAuth(options);
    }

    /**
     * Retrieves a list of all email senders from your Brevo account with optional filtering.
     *
     * **Use this to:**
     * - Get all available senders for email campaign setup
     * - Find sender details including ID, name, and email address
     * - Filter senders by IP address for dedicated IP users
     * - Filter senders by domain for domain-specific configurations
     * - Monitor sender configuration and status
     *
     * **Key information returned:**
     * - Sender details (ID, name, email address)
     * - Sender status and verification information
     * - Associated IP addresses and domains (for dedicated IP accounts)
     * - Sender configuration settings
     *
     * **Important considerations:**
     * - Standard accounts show empty IP arrays, dedicated IP accounts show IP assignments
     * - Filtering by IP only available for accounts with dedicated IPs
     * - Domain filtering helps organize senders by business units or brands
     * - Sender status indicates if sender is active and ready for campaign use
     * - Email verification required before sender can be used in campaigns
     *
     * @param {BrevoApi.GetSendersRequest} request
     * @param {SendersClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link BrevoApi.BadRequestError}
     *
     * @example
     *     await client.senders.getSenders()
     */
    public getSenders(
        request: BrevoApi.GetSendersRequest = {},
        requestOptions?: SendersClient.RequestOptions,
    ): core.HttpResponsePromise<BrevoApi.GetSendersResponse> {
        return core.HttpResponsePromise.fromPromise(this.__getSenders(request, requestOptions));
    }

    private async __getSenders(
        request: BrevoApi.GetSendersRequest = {},
        requestOptions?: SendersClient.RequestOptions,
    ): Promise<core.WithRawResponse<BrevoApi.GetSendersResponse>> {
        const { ip, domain } = request;
        const _queryParams: Record<string, unknown> = {
            ip,
            domain,
        };
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await core.fetcher({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.BrevoApiEnvironment.Default,
                "senders",
            ),
            method: "GET",
            headers: _headers,
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: _response.body as BrevoApi.GetSendersResponse, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new BrevoApi.BadRequestError(_response.error.body as unknown, _response.rawResponse);
                default:
                    throw new errors.BrevoApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/senders");
    }

    /**
     * Creates a new email sender in your Brevo account.
     *
     * **Use this to:**
     * - Add new senders for email campaigns
     * - Configure sender identity (name and email)
     * - Associate dedicated IPs with the sender (for dedicated IP accounts)
     * - Set up domain-based sender configurations
     *
     * **Key information returned:**
     * - Created sender ID
     * - DKIM and SPF configuration status
     * - Success confirmation
     *
     * **Important considerations:**
     * - Verification email sent to specified sender address
     * - DKIM and SPF configuration affects deliverability
     * - Dedicated IP accounts require IP association during creation
     * - IP weights must sum to 100 when specified
     * - Sender must be verified before use in campaigns
     *
     * @param {BrevoApi.CreateSenderRequest} request
     * @param {SendersClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link BrevoApi.BadRequestError}
     *
     * @example
     *     await client.senders.createSender({
     *         email: "support@example.com",
     *         name: "Support Team"
     *     })
     *
     * @example
     *     await client.senders.createSender({
     *         email: "marketing@example.com",
     *         ips: [{
     *                 domain: "example.com",
     *                 ip: "203.0.113.100",
     *                 weight: 100
     *             }],
     *         name: "Marketing Team"
     *     })
     *
     * @example
     *     await client.senders.createSender({
     *         email: "newsletter@example.com",
     *         ips: [{
     *                 domain: "example.com",
     *                 ip: "203.0.113.100",
     *                 weight: 60
     *             }, {
     *                 domain: "news.example.com",
     *                 ip: "203.0.113.101",
     *                 weight: 40
     *             }],
     *         name: "Newsletter"
     *     })
     */
    public createSender(
        request: BrevoApi.CreateSenderRequest,
        requestOptions?: SendersClient.RequestOptions,
    ): core.HttpResponsePromise<BrevoApi.CreateSenderResponse> {
        return core.HttpResponsePromise.fromPromise(this.__createSender(request, requestOptions));
    }

    private async __createSender(
        request: BrevoApi.CreateSenderRequest,
        requestOptions?: SendersClient.RequestOptions,
    ): Promise<core.WithRawResponse<BrevoApi.CreateSenderResponse>> {
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await core.fetcher({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.BrevoApiEnvironment.Default,
                "senders",
            ),
            method: "POST",
            headers: _headers,
            contentType: "application/json",
            queryParameters: requestOptions?.queryParams,
            requestType: "json",
            body: request,
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: _response.body as BrevoApi.CreateSenderResponse, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new BrevoApi.BadRequestError(_response.error.body as unknown, _response.rawResponse);
                default:
                    throw new errors.BrevoApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(_response.error, _response.rawResponse, "POST", "/senders");
    }

    /**
     * Retrieves all dedicated IPs associated with your Brevo account.
     *
     * Use this to:
     * - List all your dedicated IPs
     * - Check the status of your dedicated IPs (active/inactive)
     * - Find IP addresses and associated domains for configuration purposes
     * - Monitor your IP reputation and deliverability
     * - Verify available IPs for sender configuration
     *
     * Key information returned:
     * - IP ID and address
     * - Associated domain
     * - Active status
     * - IP configuration details
     *
     * @param {SendersClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link BrevoApi.BadRequestError}
     *
     * @example
     *     await client.senders.getIps()
     */
    public getIps(requestOptions?: SendersClient.RequestOptions): core.HttpResponsePromise<BrevoApi.GetIpsResponse> {
        return core.HttpResponsePromise.fromPromise(this.__getIps(requestOptions));
    }

    private async __getIps(
        requestOptions?: SendersClient.RequestOptions,
    ): Promise<core.WithRawResponse<BrevoApi.GetIpsResponse>> {
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await core.fetcher({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.BrevoApiEnvironment.Default,
                "senders/ips",
            ),
            method: "GET",
            headers: _headers,
            queryParameters: requestOptions?.queryParams,
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: _response.body as BrevoApi.GetIpsResponse, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new BrevoApi.BadRequestError(_response.error.body as unknown, _response.rawResponse);
                default:
                    throw new errors.BrevoApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/senders/ips");
    }

    /**
     * Updates an existing email sender's configuration.
     *
     * Use this to:
     * - Modify sender display name or email address
     * - Update dedicated IP associations
     * - Change sender configuration settings
     * - Correct sender information
     *
     * Key information returned:
     * - Success confirmation
     * - Updated sender details
     *
     * @param {BrevoApi.UpdateSenderRequest} request
     * @param {SendersClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link BrevoApi.BadRequestError}
     * @throws {@link BrevoApi.NotFoundError}
     *
     * @example
     *     await client.senders.updateSender({
     *         senderId: 1000000,
     *         name: "New Support Team"
     *     })
     *
     * @example
     *     await client.senders.updateSender({
     *         senderId: 1000000,
     *         email: "newsupport@mycompany.com"
     *     })
     *
     * @example
     *     await client.senders.updateSender({
     *         senderId: 1000000,
     *         email: "marketing@mycompany.com",
     *         name: "Marketing Team"
     *     })
     *
     * @example
     *     await client.senders.updateSender({
     *         senderId: 1000000,
     *         email: "marketing@enterprise.com",
     *         ips: [{
     *                 domain: "enterprise.com",
     *                 ip: "192.168.1.100",
     *                 weight: 100
     *             }],
     *         name: "Enterprise Marketing"
     *     })
     *
     * @example
     *     await client.senders.updateSender({
     *         senderId: 1000000,
     *         email: "campaigns@enterprise.com",
     *         ips: [{
     *                 domain: "enterprise.com",
     *                 ip: "192.168.1.100",
     *                 weight: 70
     *             }, {
     *                 domain: "mail.enterprise.com",
     *                 ip: "192.168.1.101",
     *                 weight: 30
     *             }],
     *         name: "Multi-IP Sender"
     *     })
     */
    public updateSender(
        request: BrevoApi.UpdateSenderRequest,
        requestOptions?: SendersClient.RequestOptions,
    ): core.HttpResponsePromise<void> {
        return core.HttpResponsePromise.fromPromise(this.__updateSender(request, requestOptions));
    }

    private async __updateSender(
        request: BrevoApi.UpdateSenderRequest,
        requestOptions?: SendersClient.RequestOptions,
    ): Promise<core.WithRawResponse<void>> {
        const { senderId, ..._body } = request;
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await core.fetcher({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.BrevoApiEnvironment.Default,
                `senders/${core.url.encodePathParam(senderId)}`,
            ),
            method: "PUT",
            headers: _headers,
            contentType: "application/json",
            queryParameters: requestOptions?.queryParams,
            requestType: "json",
            body: _body,
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: undefined, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new BrevoApi.BadRequestError(_response.error.body as unknown, _response.rawResponse);
                case 404:
                    throw new BrevoApi.NotFoundError(_response.error.body as unknown, _response.rawResponse);
                default:
                    throw new errors.BrevoApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(_response.error, _response.rawResponse, "PUT", "/senders/{senderId}");
    }

    /**
     * Deletes an email sender from your Brevo account.
     *
     * Use this to:
     * - Remove senders that are no longer needed
     * - Clean up sender configurations
     * - Remove duplicate or test senders
     *
     * Key information returned:
     * - Success confirmation message
     *
     * @param {BrevoApi.DeleteSenderRequest} request
     * @param {SendersClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link BrevoApi.BadRequestError}
     * @throws {@link BrevoApi.NotFoundError}
     *
     * @example
     *     await client.senders.deleteSender({
     *         senderId: 1000000
     *     })
     */
    public deleteSender(
        request: BrevoApi.DeleteSenderRequest,
        requestOptions?: SendersClient.RequestOptions,
    ): core.HttpResponsePromise<void> {
        return core.HttpResponsePromise.fromPromise(this.__deleteSender(request, requestOptions));
    }

    private async __deleteSender(
        request: BrevoApi.DeleteSenderRequest,
        requestOptions?: SendersClient.RequestOptions,
    ): Promise<core.WithRawResponse<void>> {
        const { senderId } = request;
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await core.fetcher({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.BrevoApiEnvironment.Default,
                `senders/${core.url.encodePathParam(senderId)}`,
            ),
            method: "DELETE",
            headers: _headers,
            queryParameters: requestOptions?.queryParams,
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: undefined, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new BrevoApi.BadRequestError(_response.error.body as unknown, _response.rawResponse);
                case 404:
                    throw new BrevoApi.NotFoundError(_response.error.body as unknown, _response.rawResponse);
                default:
                    throw new errors.BrevoApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(_response.error, _response.rawResponse, "DELETE", "/senders/{senderId}");
    }

    /**
     * Retrieves the dedicated IPs associated with a specific sender.
     *
     * Use this to:
     * - Check IP configuration for a sender
     * - Verify dedicated IP associations
     * - Get IP details for troubleshooting
     * - Monitor sender IP configuration
     *
     * Key information returned:
     * - List of associated dedicated IPs
     * - IP addresses and domain configurations
     * - IP status and settings
     *
     * @param {BrevoApi.GetIpsFromSenderRequest} request
     * @param {SendersClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link BrevoApi.BadRequestError}
     * @throws {@link BrevoApi.NotFoundError}
     *
     * @example
     *     await client.senders.getIpsFromSender({
     *         senderId: 1000000
     *     })
     */
    public getIpsFromSender(
        request: BrevoApi.GetIpsFromSenderRequest,
        requestOptions?: SendersClient.RequestOptions,
    ): core.HttpResponsePromise<BrevoApi.GetIpsFromSenderResponse> {
        return core.HttpResponsePromise.fromPromise(this.__getIpsFromSender(request, requestOptions));
    }

    private async __getIpsFromSender(
        request: BrevoApi.GetIpsFromSenderRequest,
        requestOptions?: SendersClient.RequestOptions,
    ): Promise<core.WithRawResponse<BrevoApi.GetIpsFromSenderResponse>> {
        const { senderId } = request;
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await core.fetcher({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.BrevoApiEnvironment.Default,
                `senders/${core.url.encodePathParam(senderId)}/ips`,
            ),
            method: "GET",
            headers: _headers,
            queryParameters: requestOptions?.queryParams,
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: _response.body as BrevoApi.GetIpsFromSenderResponse, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new BrevoApi.BadRequestError(_response.error.body as unknown, _response.rawResponse);
                case 404:
                    throw new BrevoApi.NotFoundError(_response.error.body as unknown, _response.rawResponse);
                default:
                    throw new errors.BrevoApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/senders/{senderId}/ips");
    }

    /**
     * Validates a sender using the OTP (One-Time Password) received via email.
     *
     * Use this to:
     * - Complete sender verification process
     * - Activate a newly created sender
     * - Verify ownership of the sender email address
     * - Enable the sender for use in email campaigns
     *
     * Key information returned:
     * - Success confirmation of sender verification
     * - Sender activation status
     *
     * @param {BrevoApi.ValidateSenderByOtpRequest} request
     * @param {SendersClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link BrevoApi.BadRequestError}
     * @throws {@link BrevoApi.NotFoundError}
     *
     * @example
     *     await client.senders.validateSenderByOtp({
     *         senderId: 1000000,
     *         otp: 123456
     *     })
     *
     * @example
     *     await client.senders.validateSenderByOtp({
     *         senderId: 1000000,
     *         otp: 789012
     *     })
     */
    public validateSenderByOtp(
        request: BrevoApi.ValidateSenderByOtpRequest,
        requestOptions?: SendersClient.RequestOptions,
    ): core.HttpResponsePromise<void> {
        return core.HttpResponsePromise.fromPromise(this.__validateSenderByOtp(request, requestOptions));
    }

    private async __validateSenderByOtp(
        request: BrevoApi.ValidateSenderByOtpRequest,
        requestOptions?: SendersClient.RequestOptions,
    ): Promise<core.WithRawResponse<void>> {
        const { senderId, ..._body } = request;
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await core.fetcher({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    (await core.Supplier.get(this._options.environment)) ??
                    environments.BrevoApiEnvironment.Default,
                `senders/${core.url.encodePathParam(senderId)}/validate`,
            ),
            method: "PUT",
            headers: _headers,
            contentType: "application/json",
            queryParameters: requestOptions?.queryParams,
            requestType: "json",
            body: _body,
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: undefined, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new BrevoApi.BadRequestError(_response.error.body as unknown, _response.rawResponse);
                case 404:
                    throw new BrevoApi.NotFoundError(_response.error.body as unknown, _response.rawResponse);
                default:
                    throw new errors.BrevoApiError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(_response.error, _response.rawResponse, "PUT", "/senders/{senderId}/validate");
    }
}
