// This file was auto-generated by Fern from our API Definition.

import * as BrevoApi from "../../src/api/index";
import { BrevoApiClient } from "../../src/Client";
import { mockServerPool } from "../mock-server/MockServerPool";

describe("SendersClient", () => {
    test("getSenders (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            senders: [
                {
                    active: true,
                    email: "support@example.com",
                    id: 1,
                    ips: [{ domain: "example.com", ip: "203.0.113.100", weight: 50 }],
                    name: "Support Team",
                },
                {
                    active: false,
                    email: "hello@example.com",
                    id: 3,
                    ips: [{ domain: "example.com", ip: "203.0.113.100", weight: 50 }],
                    name: "Customer Service",
                },
                {
                    active: false,
                    email: "marketing@testcompany.com",
                    id: 5,
                    ips: [{ domain: "example.com", ip: "203.0.113.100", weight: 50 }],
                    name: "Marketing Team",
                },
            ],
        };
        server.mockEndpoint().get("/senders").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.senders.getSenders();
        expect(response).toEqual({
            senders: [
                {
                    active: true,
                    email: "support@example.com",
                    id: 1,
                    ips: [
                        {
                            domain: "example.com",
                            ip: "203.0.113.100",
                            weight: 50,
                        },
                    ],
                    name: "Support Team",
                },
                {
                    active: false,
                    email: "hello@example.com",
                    id: 3,
                    ips: [
                        {
                            domain: "example.com",
                            ip: "203.0.113.100",
                            weight: 50,
                        },
                    ],
                    name: "Customer Service",
                },
                {
                    active: false,
                    email: "marketing@testcompany.com",
                    id: 5,
                    ips: [
                        {
                            domain: "example.com",
                            ip: "203.0.113.100",
                            weight: 50,
                        },
                    ],
                    name: "Marketing Team",
                },
            ],
        });
    });

    test("getSenders (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            senders: [
                {
                    active: true,
                    email: "marketing@example.com",
                    id: 10,
                    ips: [{ domain: "example.com", ip: "203.0.113.100", weight: 100 }],
                    name: "Marketing",
                },
                {
                    active: false,
                    email: "newsletter@example.com",
                    id: 11,
                    ips: [
                        { domain: "example.com", ip: "203.0.113.100", weight: 50 },
                        { domain: "news.example.com", ip: "203.0.113.101", weight: 50 },
                    ],
                    name: "Newsletter",
                },
            ],
        };
        server.mockEndpoint().get("/senders").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.senders.getSenders();
        expect(response).toEqual({
            senders: [
                {
                    active: true,
                    email: "marketing@example.com",
                    id: 10,
                    ips: [
                        {
                            domain: "example.com",
                            ip: "203.0.113.100",
                            weight: 100,
                        },
                    ],
                    name: "Marketing",
                },
                {
                    active: false,
                    email: "newsletter@example.com",
                    id: 11,
                    ips: [
                        {
                            domain: "example.com",
                            ip: "203.0.113.100",
                            weight: 50,
                        },
                        {
                            domain: "news.example.com",
                            ip: "203.0.113.101",
                            weight: 50,
                        },
                    ],
                    name: "Newsletter",
                },
            ],
        });
    });

    test("getSenders (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/senders").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.senders.getSenders();
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("createSender (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { email: "support@example.com", name: "Support Team" };
        const rawResponseBody = { dkimError: false, id: 15, spfError: false };
        server
            .mockEndpoint()
            .post("/senders")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.senders.createSender({
            email: "support@example.com",
            name: "Support Team",
        });
        expect(response).toEqual({
            dkimError: false,
            id: 15,
            spfError: false,
        });
    });

    test("createSender (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            email: "marketing@example.com",
            ips: [{ domain: "example.com", ip: "203.0.113.100", weight: 100 }],
            name: "Marketing Team",
        };
        const rawResponseBody = { dkimError: false, id: 15, spfError: false };
        server
            .mockEndpoint()
            .post("/senders")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.senders.createSender({
            email: "marketing@example.com",
            ips: [
                {
                    domain: "example.com",
                    ip: "203.0.113.100",
                    weight: 100,
                },
            ],
            name: "Marketing Team",
        });
        expect(response).toEqual({
            dkimError: false,
            id: 15,
            spfError: false,
        });
    });

    test("createSender (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            email: "newsletter@example.com",
            ips: [
                { domain: "example.com", ip: "203.0.113.100", weight: 60 },
                { domain: "news.example.com", ip: "203.0.113.101", weight: 40 },
            ],
            name: "Newsletter",
        };
        const rawResponseBody = { dkimError: false, id: 15, spfError: false };
        server
            .mockEndpoint()
            .post("/senders")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.senders.createSender({
            email: "newsletter@example.com",
            ips: [
                {
                    domain: "example.com",
                    ip: "203.0.113.100",
                    weight: 60,
                },
                {
                    domain: "news.example.com",
                    ip: "203.0.113.101",
                    weight: 40,
                },
            ],
            name: "Newsletter",
        });
        expect(response).toEqual({
            dkimError: false,
            id: 15,
            spfError: false,
        });
    });

    test("createSender (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { email: "support@example.com", name: "Support Team" };
        const rawResponseBody = { dkimError: false, id: 15, spfError: false };
        server
            .mockEndpoint()
            .post("/senders")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.senders.createSender({
            email: "support@example.com",
            name: "Support Team",
        });
        expect(response).toEqual({
            dkimError: false,
            id: 15,
            spfError: false,
        });
    });

    test("createSender (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { email: "support@example.com", name: "Support Team" };
        const rawResponseBody = { dkimError: true, id: 16, spfError: false };
        server
            .mockEndpoint()
            .post("/senders")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.senders.createSender({
            email: "support@example.com",
            name: "Support Team",
        });
        expect(response).toEqual({
            dkimError: true,
            id: 16,
            spfError: false,
        });
    });

    test("createSender (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { email: "email", name: "name" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/senders")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.senders.createSender({
                email: "email",
                name: "name",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getIps (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            ips: [{ active: true, domain: "mailing.enterprise.com", id: 3, ip: "192.168.1.100" }],
        };
        server.mockEndpoint().get("/senders/ips").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.senders.getIps();
        expect(response).toEqual({
            ips: [
                {
                    active: true,
                    domain: "mailing.enterprise.com",
                    id: 3,
                    ip: "192.168.1.100",
                },
            ],
        });
    });

    test("getIps (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            ips: [
                { active: true, domain: "mailing.enterprise.com", id: 3, ip: "192.168.1.100" },
                { active: true, domain: "newsletter.enterprise.com", id: 5, ip: "192.168.1.101" },
                { active: false, domain: "notifications.enterprise.com", id: 6, ip: "192.168.1.102" },
            ],
        };
        server.mockEndpoint().get("/senders/ips").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.senders.getIps();
        expect(response).toEqual({
            ips: [
                {
                    active: true,
                    domain: "mailing.enterprise.com",
                    id: 3,
                    ip: "192.168.1.100",
                },
                {
                    active: true,
                    domain: "newsletter.enterprise.com",
                    id: 5,
                    ip: "192.168.1.101",
                },
                {
                    active: false,
                    domain: "notifications.enterprise.com",
                    id: 6,
                    ip: "192.168.1.102",
                },
            ],
        });
    });

    test("getIps (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/senders/ips").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.senders.getIps();
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("updateSender (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { name: "New Support Team" };

        server.mockEndpoint().put("/senders/1000000").jsonBody(rawRequestBody).respondWith().statusCode(200).build();

        const response = await client.senders.updateSender({
            senderId: 1000000,
            name: "New Support Team",
        });
        expect(response).toEqual(undefined);
    });

    test("updateSender (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { email: "newsupport@mycompany.com" };

        server.mockEndpoint().put("/senders/1000000").jsonBody(rawRequestBody).respondWith().statusCode(200).build();

        const response = await client.senders.updateSender({
            senderId: 1000000,
            email: "newsupport@mycompany.com",
        });
        expect(response).toEqual(undefined);
    });

    test("updateSender (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { email: "marketing@mycompany.com", name: "Marketing Team" };

        server.mockEndpoint().put("/senders/1000000").jsonBody(rawRequestBody).respondWith().statusCode(200).build();

        const response = await client.senders.updateSender({
            senderId: 1000000,
            email: "marketing@mycompany.com",
            name: "Marketing Team",
        });
        expect(response).toEqual(undefined);
    });

    test("updateSender (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            email: "marketing@enterprise.com",
            ips: [{ domain: "enterprise.com", ip: "192.168.1.100", weight: 100 }],
            name: "Enterprise Marketing",
        };

        server.mockEndpoint().put("/senders/1000000").jsonBody(rawRequestBody).respondWith().statusCode(200).build();

        const response = await client.senders.updateSender({
            senderId: 1000000,
            email: "marketing@enterprise.com",
            ips: [
                {
                    domain: "enterprise.com",
                    ip: "192.168.1.100",
                    weight: 100,
                },
            ],
            name: "Enterprise Marketing",
        });
        expect(response).toEqual(undefined);
    });

    test("updateSender (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            email: "campaigns@enterprise.com",
            ips: [
                { domain: "enterprise.com", ip: "192.168.1.100", weight: 70 },
                { domain: "mail.enterprise.com", ip: "192.168.1.101", weight: 30 },
            ],
            name: "Multi-IP Sender",
        };

        server.mockEndpoint().put("/senders/1000000").jsonBody(rawRequestBody).respondWith().statusCode(200).build();

        const response = await client.senders.updateSender({
            senderId: 1000000,
            email: "campaigns@enterprise.com",
            ips: [
                {
                    domain: "enterprise.com",
                    ip: "192.168.1.100",
                    weight: 70,
                },
                {
                    domain: "mail.enterprise.com",
                    ip: "192.168.1.101",
                    weight: 30,
                },
            ],
            name: "Multi-IP Sender",
        });
        expect(response).toEqual(undefined);
    });

    test("updateSender (6)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .put("/senders/1000000")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.senders.updateSender({
                senderId: 1000000,
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("updateSender (7)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .put("/senders/1000000")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.senders.updateSender({
                senderId: 1000000,
            });
        }).rejects.toThrow(BrevoApi.NotFoundError);
    });

    test("deleteSender (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        server.mockEndpoint().delete("/senders/1000000").respondWith().statusCode(200).build();

        const response = await client.senders.deleteSender({
            senderId: 1000000,
        });
        expect(response).toEqual(undefined);
    });

    test("deleteSender (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .delete("/senders/1000000")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.senders.deleteSender({
                senderId: 1000000,
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("deleteSender (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .delete("/senders/1000000")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.senders.deleteSender({
                senderId: 1000000,
            });
        }).rejects.toThrow(BrevoApi.NotFoundError);
    });

    test("getIpsFromSender (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { ips: [{ domain: "mailing.enterprise.com", id: 3, ip: "192.168.1.100", weight: 75 }] };
        server
            .mockEndpoint()
            .get("/senders/1000000/ips")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.senders.getIpsFromSender({
            senderId: 1000000,
        });
        expect(response).toEqual({
            ips: [
                {
                    domain: "mailing.enterprise.com",
                    id: 3,
                    ip: "192.168.1.100",
                    weight: 75,
                },
            ],
        });
    });

    test("getIpsFromSender (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            ips: [
                { domain: "mailing.enterprise.com", id: 3, ip: "192.168.1.100", weight: 40 },
                { domain: "newsletter.enterprise.com", id: 5, ip: "192.168.1.101", weight: 60 },
            ],
        };
        server
            .mockEndpoint()
            .get("/senders/1000000/ips")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.senders.getIpsFromSender({
            senderId: 1000000,
        });
        expect(response).toEqual({
            ips: [
                {
                    domain: "mailing.enterprise.com",
                    id: 3,
                    ip: "192.168.1.100",
                    weight: 40,
                },
                {
                    domain: "newsletter.enterprise.com",
                    id: 5,
                    ip: "192.168.1.101",
                    weight: 60,
                },
            ],
        });
    });

    test("getIpsFromSender (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/senders/1000000/ips")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.senders.getIpsFromSender({
                senderId: 1000000,
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getIpsFromSender (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/senders/1000000/ips")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.senders.getIpsFromSender({
                senderId: 1000000,
            });
        }).rejects.toThrow(BrevoApi.NotFoundError);
    });

    test("validateSenderByOTP (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { otp: 123456 };

        server
            .mockEndpoint()
            .put("/senders/1000000/validate")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .build();

        const response = await client.senders.validateSenderByOtp({
            senderId: 1000000,
            otp: 123456,
        });
        expect(response).toEqual(undefined);
    });

    test("validateSenderByOTP (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { otp: 789012 };

        server
            .mockEndpoint()
            .put("/senders/1000000/validate")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .build();

        const response = await client.senders.validateSenderByOtp({
            senderId: 1000000,
            otp: 789012,
        });
        expect(response).toEqual(undefined);
    });

    test("validateSenderByOTP (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { otp: 999999 };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .put("/senders/1000000/validate")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.senders.validateSenderByOtp({
                senderId: 1000000,
                otp: 999999,
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("validateSenderByOTP (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { otp: 999999 };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .put("/senders/1000000/validate")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.senders.validateSenderByOtp({
                senderId: 1000000,
                otp: 999999,
            });
        }).rejects.toThrow(BrevoApi.NotFoundError);
    });
});
