// This file was auto-generated by Fern from our API Definition.

import * as BrevoApi from "../../src/api/index";
import { BrevoApiClient } from "../../src/Client";
import { mockServerPool } from "../mock-server/MockServerPool";

describe("EcommerceClient", () => {
    test("getCategories (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            categories: [
                {
                    createdAt: "2021-12-31T11:42:35.638Z",
                    id: "C19",
                    isDeleted: true,
                    modifiedAt: "2022-03-03T14:48:31.867Z",
                    name: "Food",
                    url: "http://mydomain.com/category/food",
                },
                {
                    createdAt: "2021-12-31T11:42:35.638Z",
                    id: "C20",
                    isDeleted: true,
                    modifiedAt: "2022-03-03T14:48:31.867Z",
                    name: "clothing",
                    url: "http://mydomain.com/category/clothing",
                },
            ],
            count: 2,
        };
        server.mockEndpoint().get("/categories").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.ecommerce.getCategories();
        expect(response).toEqual({
            categories: [
                {
                    createdAt: "2021-12-31T11:42:35.638Z",
                    id: "C19",
                    isDeleted: true,
                    modifiedAt: "2022-03-03T14:48:31.867Z",
                    name: "Food",
                    url: "http://mydomain.com/category/food",
                },
                {
                    createdAt: "2021-12-31T11:42:35.638Z",
                    id: "C20",
                    isDeleted: true,
                    modifiedAt: "2022-03-03T14:48:31.867Z",
                    name: "clothing",
                    url: "http://mydomain.com/category/clothing",
                },
            ],
            count: 2,
        });
    });

    test("getCategories (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/categories").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.ecommerce.getCategories();
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("createUpdateCategory (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { id: "CAT123" };
        const rawResponseBody = { id: 21 };
        server
            .mockEndpoint()
            .post("/categories")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.ecommerce.createUpdateCategory({
            id: "CAT123",
        });
        expect(response).toEqual({
            id: 21,
        });
    });

    test("createUpdateCategory (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { id: "id" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/categories")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.createUpdateCategory({
                id: "id",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("createUpdateBatchCategory (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { categories: [{ id: "CAT123" }] };
        const rawResponseBody = { createdCount: 2, updatedCount: 7 };
        server
            .mockEndpoint()
            .post("/categories/batch")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.ecommerce.createUpdateBatchCategory({
            categories: [
                {
                    id: "CAT123",
                },
            ],
        });
        expect(response).toEqual({
            createdCount: 2,
            updatedCount: 7,
        });
    });

    test("createUpdateBatchCategory (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { categories: [{ id: "id" }, { id: "id" }] };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/categories/batch")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.createUpdateBatchCategory({
                categories: [
                    {
                        id: "id",
                    },
                    {
                        id: "id",
                    },
                ],
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getCategoryInfo (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            createdAt: "2017-05-12T12:30:00Z",
            id: "C11",
            isDeleted: true,
            modifiedAt: "2017-05-12T12:30:00Z",
            name: "Electronics",
            url: "http://mydomain.com/category/clothing",
        };
        server.mockEndpoint().get("/categories/id").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.ecommerce.getCategoryInfo({
            id: "id",
        });
        expect(response).toEqual({
            createdAt: "2017-05-12T12:30:00Z",
            id: "C11",
            isDeleted: true,
            modifiedAt: "2017-05-12T12:30:00Z",
            name: "Electronics",
            url: "http://mydomain.com/category/clothing",
        });
    });

    test("getCategoryInfo (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/categories/id").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.ecommerce.getCategoryInfo({
                id: "id",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getCategoryInfo (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/categories/id").respondWith().statusCode(404).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.ecommerce.getCategoryInfo({
                id: "id",
            });
        }).rejects.toThrow(BrevoApi.NotFoundError);
    });

    test("activateTheECommerceApp (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        server.mockEndpoint().post("/ecommerce/activate").respondWith().statusCode(200).build();

        const response = await client.ecommerce.activateTheECommerceApp();
        expect(response).toEqual(undefined);
    });

    test("activateTheECommerceApp (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/ecommerce/activate")
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.activateTheECommerceApp();
        }).rejects.toThrow(BrevoApi.UnauthorizedError);
    });

    test("activateTheECommerceApp (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/ecommerce/activate")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.activateTheECommerceApp();
        }).rejects.toThrow(BrevoApi.NotFoundError);
    });

    test("getAttributionMetricsForOneOrMoreBrevoCampaignsOrWorkflows (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            results: [
                { averageBasket: 3, conversionSource: "email_campaign", id: 1.1, ordersCount: 300, revenue: 900 },
                { averageBasket: 4, conversionSource: "email_campaign", id: 1.1, ordersCount: 200, revenue: 800 },
            ],
            totals: { averageBasket: 3.4, ordersCount: 500, revenue: 1700 },
        };
        server
            .mockEndpoint()
            .get("/ecommerce/attribution/metrics")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.ecommerce.getAttributionMetricsForOneOrMoreBrevoCampaignsOrWorkflows({
            periodFrom: "2022-01-02T00:00:00Z",
            periodTo: "2022-01-03T00:00:00Z",
        });
        expect(response).toEqual({
            results: [
                {
                    averageBasket: 3,
                    conversionSource: "email_campaign",
                    id: 1.1,
                    ordersCount: 300,
                    revenue: 900,
                },
                {
                    averageBasket: 4,
                    conversionSource: "email_campaign",
                    id: 1.1,
                    ordersCount: 200,
                    revenue: 800,
                },
            ],
            totals: {
                averageBasket: 3.4,
                ordersCount: 500,
                revenue: 1700,
            },
        });
    });

    test("getAttributionMetricsForOneOrMoreBrevoCampaignsOrWorkflows (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/ecommerce/attribution/metrics")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.getAttributionMetricsForOneOrMoreBrevoCampaignsOrWorkflows();
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getDetailedAttributionMetricsForASingleBrevoCampaignOrWorkflow (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            averageBasket: 1.1,
            conversionSource: "email_campaign",
            id: 1.1,
            ordersCount: 1.1,
            revenue: 1.1,
            newCustomersCount: 1.1,
        };
        server
            .mockEndpoint()
            .get("/ecommerce/attribution/metrics/email_campaign/sale")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.ecommerce.getDetailedAttributionMetricsForASingleBrevoCampaignOrWorkflow({
            conversionSource: "email_campaign",
            conversionSourceId: "sale",
        });
        expect(response).toEqual({
            averageBasket: 1.1,
            conversionSource: "email_campaign",
            id: 1.1,
            ordersCount: 1.1,
            revenue: 1.1,
            newCustomersCount: 1.1,
        });
    });

    test("getDetailedAttributionMetricsForASingleBrevoCampaignOrWorkflow (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/ecommerce/attribution/metrics/email_campaign/conversionSourceId")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.getDetailedAttributionMetricsForASingleBrevoCampaignOrWorkflow({
                conversionSource: "email_campaign",
                conversionSourceId: "conversionSourceId",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getAttributedProductSalesForASingleBrevoCampaignOrWorkflow (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            products: [
                {
                    id: "1",
                    imageUrl: "http://mydomain.com/product-absoulte-url/img.jpeg",
                    name: "Milky Way Galaxy",
                    ordersCount: 200,
                    price: 1000,
                    revenue: 999.99,
                    sku: "sku-1",
                    url: "https://mydomain.com/products/alpina-panoma-classic",
                },
            ],
        };
        server
            .mockEndpoint()
            .get("/ecommerce/attribution/products/email_campaign/sale")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.ecommerce.getAttributedProductSalesForASingleBrevoCampaignOrWorkflow({
            conversionSource: "email_campaign",
            conversionSourceId: "sale",
        });
        expect(response).toEqual({
            products: [
                {
                    id: "1",
                    imageUrl: "http://mydomain.com/product-absoulte-url/img.jpeg",
                    name: "Milky Way Galaxy",
                    ordersCount: 200,
                    price: 1000,
                    revenue: 999.99,
                    sku: "sku-1",
                    url: "https://mydomain.com/products/alpina-panoma-classic",
                },
            ],
        });
    });

    test("getAttributedProductSalesForASingleBrevoCampaignOrWorkflow (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/ecommerce/attribution/products/email_campaign/conversionSourceId")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.getAttributedProductSalesForASingleBrevoCampaignOrWorkflow({
                conversionSource: "email_campaign",
                conversionSourceId: "conversionSourceId",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getTheIso4217CompliantDisplayCurrencyCodeForYourBrevoAccount (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { code: "EUR" };
        server
            .mockEndpoint()
            .get("/ecommerce/config/displayCurrency")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.ecommerce.getTheIso4217CompliantDisplayCurrencyCodeForYourBrevoAccount();
        expect(response).toEqual({
            code: "EUR",
        });
    });

    test("getTheIso4217CompliantDisplayCurrencyCodeForYourBrevoAccount (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/ecommerce/config/displayCurrency")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.getTheIso4217CompliantDisplayCurrencyCodeForYourBrevoAccount();
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getTheIso4217CompliantDisplayCurrencyCodeForYourBrevoAccount (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/ecommerce/config/displayCurrency")
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.getTheIso4217CompliantDisplayCurrencyCodeForYourBrevoAccount();
        }).rejects.toThrow(BrevoApi.UnauthorizedError);
    });

    test("getTheIso4217CompliantDisplayCurrencyCodeForYourBrevoAccount (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/ecommerce/config/displayCurrency")
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.getTheIso4217CompliantDisplayCurrencyCodeForYourBrevoAccount();
        }).rejects.toThrow(BrevoApi.ForbiddenError);
    });

    test("setConfigDisplayCurrency (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { code: "EUR" };
        const rawResponseBody = { code: "EUR" };
        server
            .mockEndpoint()
            .post("/ecommerce/config/displayCurrency")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.ecommerce.setConfigDisplayCurrency({
            code: "EUR",
        });
        expect(response).toEqual({
            code: "EUR",
        });
    });

    test("setConfigDisplayCurrency (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { code: "code" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/ecommerce/config/displayCurrency")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.setConfigDisplayCurrency({
                code: "code",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("setConfigDisplayCurrency (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { code: "code" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/ecommerce/config/displayCurrency")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.setConfigDisplayCurrency({
                code: "code",
            });
        }).rejects.toThrow(BrevoApi.UnauthorizedError);
    });

    test("setConfigDisplayCurrency (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { code: "code" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/ecommerce/config/displayCurrency")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.setConfigDisplayCurrency({
                code: "code",
            });
        }).rejects.toThrow(BrevoApi.ForbiddenError);
    });

    test("setConfigDisplayCurrency (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { code: "code" };
        const rawResponseBody = { message: "message" };
        server
            .mockEndpoint()
            .post("/ecommerce/config/displayCurrency")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.setConfigDisplayCurrency({
                code: "code",
            });
        }).rejects.toThrow(BrevoApi.UnprocessableEntityError);
    });

    test("getOrders (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            count: 1,
            orders: [
                {
                    amount: 2000,
                    billing: {
                        address: "Sec 62, Noida",
                        city: "Noida",
                        country: "India",
                        countryCode: "IN",
                        paymentMethod: "Net banking",
                        phone: 9238283982,
                        postCode: 110001,
                        region: "North India",
                    },
                    contact_id: 2,
                    coupons: ["flat50", "flat40"],
                    createdAt: "2021-12-31T11:42:35.638Z",
                    email: "testvisitor@sendinblue.com",
                    id: "order1803",
                    identifiers: { ext_id: "ab12", loyalty_subscription_id: "1234" },
                    products: [
                        { price: 100, productId: 21, quantity: 2, variantId: "P100" },
                        { price: 100, productId: 21, quantity: 2, variantId: "P15756" },
                    ],
                    status: "complete",
                    storeId: "123",
                    updatedAt: "2022-03-03T14:48:31.867Z",
                },
            ],
        };
        server.mockEndpoint().get("/orders").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.ecommerce.getOrders();
        expect(response).toEqual({
            count: 1,
            orders: [
                {
                    amount: 2000,
                    billing: {
                        address: "Sec 62, Noida",
                        city: "Noida",
                        country: "India",
                        countryCode: "IN",
                        paymentMethod: "Net banking",
                        phone: 9238283982,
                        postCode: 110001,
                        region: "North India",
                    },
                    contact_id: 2,
                    coupons: ["flat50", "flat40"],
                    createdAt: "2021-12-31T11:42:35.638Z",
                    email: "testvisitor@sendinblue.com",
                    id: "order1803",
                    identifiers: {
                        ext_id: "ab12",
                        loyalty_subscription_id: "1234",
                    },
                    products: [
                        {
                            price: 100,
                            productId: 21,
                            quantity: 2,
                            variantId: "P100",
                        },
                        {
                            price: 100,
                            productId: 21,
                            quantity: 2,
                            variantId: "P15756",
                        },
                    ],
                    status: "complete",
                    storeId: "123",
                    updatedAt: "2022-03-03T14:48:31.867Z",
                },
            ],
        });
    });

    test("getOrders (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/orders").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.ecommerce.getOrders();
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("createOrder (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            amount: 308.42,
            createdAt: "2021-07-29T20:59:23.383Z",
            id: "14",
            products: [{ price: 99.99, productId: "P1", quantity: 10 }],
            status: "completed",
            updatedAt: "2021-07-30T10:59:23.383Z",
        };

        server.mockEndpoint().post("/orders/status").jsonBody(rawRequestBody).respondWith().statusCode(200).build();

        const response = await client.ecommerce.createOrder({
            amount: 308.42,
            createdAt: "2021-07-29T20:59:23.383Z",
            id: "14",
            products: [
                {
                    price: 99.99,
                    productId: "P1",
                    quantity: 10,
                },
            ],
            status: "completed",
            updatedAt: "2021-07-30T10:59:23.383Z",
        });
        expect(response).toEqual(undefined);
    });

    test("createOrder (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            amount: 1.1,
            createdAt: "createdAt",
            id: "id",
            products: [
                { price: 1.1, productId: "productId", quantity: 1.1 },
                { price: 1.1, productId: "productId", quantity: 1.1 },
            ],
            status: "status",
            updatedAt: "updatedAt",
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/orders/status")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.createOrder({
                amount: 1.1,
                createdAt: "createdAt",
                id: "id",
                products: [
                    {
                        price: 1.1,
                        productId: "productId",
                        quantity: 1.1,
                    },
                    {
                        price: 1.1,
                        productId: "productId",
                        quantity: 1.1,
                    },
                ],
                status: "status",
                updatedAt: "updatedAt",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("createBatchOrder (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            orders: [
                {
                    amount: 308.42,
                    createdAt: "2021-07-29T20:59:23.383Z",
                    id: "14",
                    products: [{ price: 99.99, productId: "P1", quantity: 10 }],
                    status: "completed",
                    updatedAt: "2021-07-30T10:59:23.383Z",
                },
            ],
        };
        const rawResponseBody = { batchId: 1.1, count: 17655 };
        server
            .mockEndpoint()
            .post("/orders/status/batch")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.ecommerce.createBatchOrder({
            orders: [
                {
                    amount: 308.42,
                    createdAt: "2021-07-29T20:59:23.383Z",
                    id: "14",
                    products: [
                        {
                            price: 99.99,
                            productId: "P1",
                            quantity: 10,
                        },
                    ],
                    status: "completed",
                    updatedAt: "2021-07-30T10:59:23.383Z",
                },
            ],
        });
        expect(response).toEqual({
            batchId: 1.1,
            count: 17655,
        });
    });

    test("createBatchOrder (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            orders: [
                {
                    amount: 1.1,
                    createdAt: "createdAt",
                    id: "id",
                    products: [
                        { price: 1.1, productId: "productId", quantity: 1.1 },
                        { price: 1.1, productId: "productId", quantity: 1.1 },
                    ],
                    status: "status",
                    updatedAt: "updatedAt",
                },
                {
                    amount: 1.1,
                    createdAt: "createdAt",
                    id: "id",
                    products: [
                        { price: 1.1, productId: "productId", quantity: 1.1 },
                        { price: 1.1, productId: "productId", quantity: 1.1 },
                    ],
                    status: "status",
                    updatedAt: "updatedAt",
                },
            ],
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/orders/status/batch")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.createBatchOrder({
                orders: [
                    {
                        amount: 1.1,
                        createdAt: "createdAt",
                        id: "id",
                        products: [
                            {
                                price: 1.1,
                                productId: "productId",
                                quantity: 1.1,
                            },
                            {
                                price: 1.1,
                                productId: "productId",
                                quantity: 1.1,
                            },
                        ],
                        status: "status",
                        updatedAt: "updatedAt",
                    },
                    {
                        amount: 1.1,
                        createdAt: "createdAt",
                        id: "id",
                        products: [
                            {
                                price: 1.1,
                                productId: "productId",
                                quantity: 1.1,
                            },
                            {
                                price: 1.1,
                                productId: "productId",
                                quantity: 1.1,
                            },
                        ],
                        status: "status",
                        updatedAt: "updatedAt",
                    },
                ],
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getProducts (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            count: 2,
            products: [
                {
                    categories: ["279638835374", "279502848174"],
                    createdAt: "2022-06-30T10:29:16.078Z",
                    id: "P11",
                    imageUrl: "http://mydomain.com/product-absoulte-url/img.jpeg",
                    isDeleted: true,
                    metaInfo: { brand: "addidas", description: "Shoes for sports" },
                    modifiedAt: "2022-06-30T10:29:16.078Z",
                    name: "Alpina Panoma Classic",
                    parentId: "parentId",
                    price: 49.95,
                    s3Original: "https://img-ecom.mailinblue.com/path-to-original/img.jpg",
                    s3ThumbAnalytics: "https://img-ecom.mailinblue.com/path-to-analytics/img.jpg",
                    s3ThumbEditor: "https://img-ecom.mailinblue.com/path-to-editor/img.jpg",
                    sku: "186622-9",
                    stock: 100,
                    url: "https://mydomain.com/products/alpina-panoma-classic",
                },
                {
                    categories: ["2d79638835374", "27d9502848174"],
                    createdAt: "2022-06-30T10:29:16.078Z",
                    id: "P11",
                    imageUrl: "http://mydomain.com/product-absoulte-url/img.jpeg",
                    isDeleted: true,
                    metaInfo: { brand: "addidas", description: "Shoes for sports" },
                    modifiedAt: "2022-06-30T10:29:16.078Z",
                    name: "Alpina Panoma Classic2",
                    parentId: "parentId",
                    price: 49.95,
                    s3Original: "https://img-ecom.mailinblue.com/path-to-original/img.jpg",
                    s3ThumbAnalytics: "https://img-ecom.mailinblue.com/path-to-analytics/img.jpg",
                    s3ThumbEditor: "https://img-ecom.mailinblue.com/path-to-editor/img.jpg",
                    sku: "186622-9",
                    stock: 350,
                    url: "https://mydomain.com/products/alpina-panoma-classic2",
                },
            ],
        };
        server.mockEndpoint().get("/products").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.ecommerce.getProducts();
        expect(response).toEqual({
            count: 2,
            products: [
                {
                    categories: ["279638835374", "279502848174"],
                    createdAt: "2022-06-30T10:29:16.078Z",
                    id: "P11",
                    imageUrl: "http://mydomain.com/product-absoulte-url/img.jpeg",
                    isDeleted: true,
                    metaInfo: {
                        brand: "addidas",
                        description: "Shoes for sports",
                    },
                    modifiedAt: "2022-06-30T10:29:16.078Z",
                    name: "Alpina Panoma Classic",
                    parentId: "parentId",
                    price: 49.95,
                    s3Original: "https://img-ecom.mailinblue.com/path-to-original/img.jpg",
                    s3ThumbAnalytics: "https://img-ecom.mailinblue.com/path-to-analytics/img.jpg",
                    s3ThumbEditor: "https://img-ecom.mailinblue.com/path-to-editor/img.jpg",
                    sku: "186622-9",
                    stock: 100,
                    url: "https://mydomain.com/products/alpina-panoma-classic",
                },
                {
                    categories: ["2d79638835374", "27d9502848174"],
                    createdAt: "2022-06-30T10:29:16.078Z",
                    id: "P11",
                    imageUrl: "http://mydomain.com/product-absoulte-url/img.jpeg",
                    isDeleted: true,
                    metaInfo: {
                        brand: "addidas",
                        description: "Shoes for sports",
                    },
                    modifiedAt: "2022-06-30T10:29:16.078Z",
                    name: "Alpina Panoma Classic2",
                    parentId: "parentId",
                    price: 49.95,
                    s3Original: "https://img-ecom.mailinblue.com/path-to-original/img.jpg",
                    s3ThumbAnalytics: "https://img-ecom.mailinblue.com/path-to-analytics/img.jpg",
                    s3ThumbEditor: "https://img-ecom.mailinblue.com/path-to-editor/img.jpg",
                    sku: "186622-9",
                    stock: 350,
                    url: "https://mydomain.com/products/alpina-panoma-classic2",
                },
            ],
        });
    });

    test("getProducts (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/products").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.ecommerce.getProducts();
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("createUpdateProduct (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { id: "P11", name: "Iphone 11" };
        const rawResponseBody = { id: 21 };
        server
            .mockEndpoint()
            .post("/products")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.ecommerce.createUpdateProduct({
            id: "P11",
            name: "Iphone 11",
        });
        expect(response).toEqual({
            id: 21,
        });
    });

    test("createUpdateProduct (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { id: "id", name: "name" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/products")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.createUpdateProduct({
                id: "id",
                name: "name",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("createUpdateBatchProducts (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { products: [{ id: "P11", name: "Iphone 11" }] };
        const rawResponseBody = { createdCount: 2, updatedCount: 7 };
        server
            .mockEndpoint()
            .post("/products/batch")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.ecommerce.createUpdateBatchProducts({
            products: [
                {
                    id: "P11",
                    name: "Iphone 11",
                },
            ],
        });
        expect(response).toEqual({
            createdCount: 2,
            updatedCount: 7,
        });
    });

    test("createUpdateBatchProducts (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            products: [
                { id: "id", name: "name" },
                { id: "id", name: "name" },
            ],
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/products/batch")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.createUpdateBatchProducts({
                products: [
                    {
                        id: "id",
                        name: "name",
                    },
                    {
                        id: "id",
                        name: "name",
                    },
                ],
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getProductInfo (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            categories: ["categories"],
            createdAt: "2017-05-12T12:30:00Z",
            id: "P11",
            imageUrl: "http://mydomain.com/product-absoulte-url/img.jpeg",
            isDeleted: true,
            metaInfo: { brand: "addidas", description: "Shoes for sports" },
            modifiedAt: "2017-05-12T12:30:00Z",
            name: "Iphone 11",
            parentId: "parentId",
            price: 1.1,
            s3Original: "s3Original",
            s3ThumbAnalytics: "s3ThumbAnalytics",
            s3ThumbEditor: "s3ThumbEditor",
            sku: "sku",
            stock: 100,
            url: "http://mydomain.com/product/electronics/product1",
        };
        server.mockEndpoint().get("/products/id").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.ecommerce.getProductInfo({
            id: "id",
        });
        expect(response).toEqual({
            categories: ["categories"],
            createdAt: "2017-05-12T12:30:00Z",
            id: "P11",
            imageUrl: "http://mydomain.com/product-absoulte-url/img.jpeg",
            isDeleted: true,
            metaInfo: {
                brand: "addidas",
                description: "Shoes for sports",
            },
            modifiedAt: "2017-05-12T12:30:00Z",
            name: "Iphone 11",
            parentId: "parentId",
            price: 1.1,
            s3Original: "s3Original",
            s3ThumbAnalytics: "s3ThumbAnalytics",
            s3ThumbEditor: "s3ThumbEditor",
            sku: "sku",
            stock: 100,
            url: "http://mydomain.com/product/electronics/product1",
        });
    });

    test("getProductInfo (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/products/id").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.ecommerce.getProductInfo({
                id: "id",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getProductInfo (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/products/id").respondWith().statusCode(404).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.ecommerce.getProductInfo({
                id: "id",
            });
        }).rejects.toThrow(BrevoApi.NotFoundError);
    });

    test("createProductAlert (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};

        server
            .mockEndpoint()
            .post("/products/id/alerts/back_in_stock")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .build();

        const response = await client.ecommerce.createProductAlert({
            id: "id",
            type: "back_in_stock",
        });
        expect(response).toEqual(undefined);
    });

    test("createProductAlert (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/products/id/alerts/back_in_stock")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.createProductAlert({
                id: "id",
                type: "back_in_stock",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("createProductAlert (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/products/id/alerts/back_in_stock")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.createProductAlert({
                id: "id",
                type: "back_in_stock",
            });
        }).rejects.toThrow(BrevoApi.UnauthorizedError);
    });

    test("createProductAlert (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/products/id/alerts/back_in_stock")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.createProductAlert({
                id: "id",
                type: "back_in_stock",
            });
        }).rejects.toThrow(BrevoApi.ForbiddenError);
    });

    test("createProductAlert (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/products/id/alerts/back_in_stock")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.ecommerce.createProductAlert({
                id: "id",
                type: "back_in_stock",
            });
        }).rejects.toThrow(BrevoApi.NotFoundError);
    });
});
