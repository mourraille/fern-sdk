// This file was auto-generated by Fern from our API Definition.

import * as BrevoApi from "../../src/api/index";
import { BrevoApiClient } from "../../src/Client";
import { mockServerPool } from "../mock-server/MockServerPool";

describe("NotesClient", () => {
    test("getAllNotes (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = [
            {
                authorId: {
                    email: "johndoe@example.com",
                    id: "61a5ce58y5d4795761045991",
                    locale: "en_GB",
                    name: { fullName: "John Doe" },
                    timezone: "Asia/Kolkata",
                },
                contactIds: [247, 1, 2],
                createdAt: "2017-05-01T17:05:03Z",
                dealIds: ["61a5ce58c5d4795761045990", "61a5ce58c5d4795761045991"],
                id: "61a5cd07ca1347c82306ad09",
                text: "In communication with client_dev for resolution of queries.",
                updatedAt: "2017-05-01T17:05:03Z",
            },
        ];
        server.mockEndpoint().get("/crm/notes").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.notes.getAllNotes();
        expect(response).toEqual([
            {
                authorId: {
                    email: "johndoe@example.com",
                    id: "61a5ce58y5d4795761045991",
                    locale: "en_GB",
                    name: {
                        fullName: "John Doe",
                    },
                    timezone: "Asia/Kolkata",
                },
                contactIds: [247, 1, 2],
                createdAt: "2017-05-01T17:05:03Z",
                dealIds: ["61a5ce58c5d4795761045990", "61a5ce58c5d4795761045991"],
                id: "61a5cd07ca1347c82306ad09",
                text: "In communication with client_dev for resolution of queries.",
                updatedAt: "2017-05-01T17:05:03Z",
            },
        ]);
    });

    test("getAllNotes (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/crm/notes").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.notes.getAllNotes();
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("createANote (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "In communication with client_dev for resolution of queries." };
        const rawResponseBody = { id: "61a5cd07ca1347c82306ad09" };
        server
            .mockEndpoint()
            .post("/crm/notes")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.notes.createANote({
            text: "In communication with client_dev for resolution of queries.",
        });
        expect(response).toEqual({
            id: "61a5cd07ca1347c82306ad09",
        });
    });

    test("createANote (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "x" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/crm/notes")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.notes.createANote({
                text: "x",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("createANote (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "x" };
        const rawResponseBody = { message: "message" };
        server
            .mockEndpoint()
            .post("/crm/notes")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(415)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.notes.createANote({
                text: "x",
            });
        }).rejects.toThrow(BrevoApi.UnsupportedMediaTypeError);
    });

    test("getANote (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            authorId: {
                email: "johndoe@example.com",
                id: "61a5ce58y5d4795761045991",
                locale: "en_GB",
                name: { fullName: "John Doe" },
                timezone: "Asia/Kolkata",
            },
            contactIds: [247, 1, 2],
            createdAt: "2017-05-01T17:05:03Z",
            dealIds: ["61a5ce58c5d4795761045990", "61a5ce58c5d4795761045991"],
            id: "61a5cd07ca1347c82306ad09",
            text: "In communication with client_dev for resolution of queries.",
            updatedAt: "2017-05-01T17:05:03Z",
        };
        server.mockEndpoint().get("/crm/notes/id").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.notes.getANote({
            id: "id",
        });
        expect(response).toEqual({
            authorId: {
                email: "johndoe@example.com",
                id: "61a5ce58y5d4795761045991",
                locale: "en_GB",
                name: {
                    fullName: "John Doe",
                },
                timezone: "Asia/Kolkata",
            },
            contactIds: [247, 1, 2],
            createdAt: "2017-05-01T17:05:03Z",
            dealIds: ["61a5ce58c5d4795761045990", "61a5ce58c5d4795761045991"],
            id: "61a5cd07ca1347c82306ad09",
            text: "In communication with client_dev for resolution of queries.",
            updatedAt: "2017-05-01T17:05:03Z",
        });
    });

    test("getANote (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/crm/notes/id").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.notes.getANote({
                id: "id",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("getANote (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/crm/notes/id").respondWith().statusCode(404).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.notes.getANote({
                id: "id",
            });
        }).rejects.toThrow(BrevoApi.NotFoundError);
    });

    test("deleteANote (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        server.mockEndpoint().delete("/crm/notes/id").respondWith().statusCode(200).build();

        const response = await client.notes.deleteANote({
            id: "id",
        });
        expect(response).toEqual(undefined);
    });

    test("deleteANote (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().delete("/crm/notes/id").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.notes.deleteANote({
                id: "id",
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("deleteANote (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().delete("/crm/notes/id").respondWith().statusCode(404).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.notes.deleteANote({
                id: "id",
            });
        }).rejects.toThrow(BrevoApi.NotFoundError);
    });

    test("updateANote (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "In communication with client_dev for resolution of queries." };

        server.mockEndpoint().patch("/crm/notes/id").jsonBody(rawRequestBody).respondWith().statusCode(200).build();

        const response = await client.notes.updateANote({
            id: "id",
            body: {
                text: "In communication with client_dev for resolution of queries.",
            },
        });
        expect(response).toEqual(undefined);
    });

    test("updateANote (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "x" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .patch("/crm/notes/id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.notes.updateANote({
                id: "id",
                body: {
                    text: "x",
                },
            });
        }).rejects.toThrow(BrevoApi.BadRequestError);
    });

    test("updateANote (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "x" };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .patch("/crm/notes/id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.notes.updateANote({
                id: "id",
                body: {
                    text: "x",
                },
            });
        }).rejects.toThrow(BrevoApi.NotFoundError);
    });

    test("updateANote (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new BrevoApiClient({ maxRetries: 0, apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { text: "x" };
        const rawResponseBody = { message: "message" };
        server
            .mockEndpoint()
            .patch("/crm/notes/id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(415)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.notes.updateANote({
                id: "id",
                body: {
                    text: "x",
                },
            });
        }).rejects.toThrow(BrevoApi.UnsupportedMediaTypeError);
    });
});
